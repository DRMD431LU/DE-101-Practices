create table t_industry
(
id     int,
name  varchar(255)
);
create table t_customer_status_history
(id int,
 start_date date,
 end_date date,
 status varchar(255)
 );
 
insert into t_customer_status_history values
(1, '2021-01-01', '2021-01-28','Active'),
(1, '2021-01-28', '2021-02-03', 'Inactive'),
(1, '2021-02-01', '2021-02-28', 'Active'),
(1, '2021-02-28', '2021-03-28', 'Active'),
(2, '2021-01-01', '2021-01-28','Active'),
(2, '2021-01-10', '2021-02-01', 'Inactive'),
(2, '2021-02-01', '2021-03-28', 'Active'),
(3, '2021-01-01', '2021-01-28','Active'),
(3, '2021-01-28', '2021-02-01', 'Active'),
(3, '2021-02-01', '2021-03-28', 'Active'),
(4, '2021-01-01', '2021-01-15','Active'),
(4, '2021-01-15', '2021-02-03', 'Inactive'),
(4, '2021-02-03', '2021-02-05', 'Inactive'),
(4, '2021-02-05', '2021-03-28', 'Active');
create table t_customer
(id int ,
 industry_id int,
 name varchar(255),
 status varchar(255)
);
 
Create table t_transaction
(
id int,
customer_id int,
txn_amount int,
txn_date date
);

Insert into t_industry
values
(1,'Hospitality'),
(2,'Food Services'),
(3,'Technologies'),
(4,'Clothing');

Insert into t_customer
values
(1,1,'John','Active'),
(2,2,'Ava', 'Active'),
(3,2,'Cailin', 'Deleted'),
(4,4,'Sarah','Suspended'),
(5,3,'Ian', 'Active'),
(6,3,'Peter','Active'),
 (7,4,'William','Suspended'),
 (8,4,'Amy','Active'),
 (9,4,'Mike','Deleted'),
 (10,4,'Eva','Active'),
 (11,4,'Zack','Active'),
 (12,4,'Caleb','Active')
 ;
insert into t_transaction
VALUES(1,8,15450,'2020-11-29'),
(2,4,2200,'2020-09-21'),
(3,7,1500,'2020-01-09'),
(4,11,2900,'2020-05-10'),
(5,6,2700,'2020-09-29'),
(6,10,1500,'2020-11-11'),
(7,9,1800,'2020-02-01'),
(8,10,2100,'2020-04-04'),
(9,11,600,'2020-11-08'),
(10,6,1000,'2020-07-14'),
(11,3,2000,'2020-03-18'),
(12,7,600,'2020-04-08'),
(13,6,1500,'2020-07-23'),
(14,6,1700,'2020-03-19'),
(15,5,800,'2020-01-19'),
(16,3,3000,'2020-11-24'),
(17,3,1300,'2020-08-17'),
(18,11,1700,'2020-05-25'),
(19,6,2900,'2020-09-09'),
(20,11,200,'2020-10-03'),
(21,9,3000,'2020-11-16'),
(22,5,3300,'2020-11-04'),
(23,2,2600,'2020-11-06'),
(24,2,3200,'2020-09-26'),
(25,11,2400,'2020-10-24'),
(26,7,1000,'2020-03-14'),
(27,2,2700,'2020-04-04'),
(28,2,1100,'2020-11-08'),
(29,11,600,'2020-04-06'),
(30,11,1300,'2020-05-26'),
(31,5,3500,'2020-02-06'),
(32,7,1700,'2020-09-22'),
(33,11,2600,'2020-01-28'),
(34,8,400,'2020-04-04'),
(35,3,900,'2020-07-29'),
(36,1,900,'2020-02-27'),
(37,11,1900,'2020-04-24'),
(38,11,3000,'2020-08-27'),
(39,4,2600,'2020-07-12'),
(40,10,1100,'2020-04-19'),
(41,5,3000,'2020-02-07'),
(42,4,3000,'2020-08-24'),
(43,8,2400,'2020-09-06'),
(44,7,1600,'2020-06-10'),
(45,9,2300,'2020-10-05'),
(46,7,100,'2020-11-29'),
(47,4,3500,'2020-03-16'),
(48,9,2200,'2020-07-11'),
(49,3,2700,'2020-03-16'),
(50,7,1100,'2020-10-12'),
(51,9,300,'2020-07-20'),
(52,5,1300,'2020-05-11'),
(53,1,2600,'2020-02-06'),
(54,10,1900,'2020-03-12'),
(55,7,1800,'2020-05-09'),
(56,9,2100,'2020-07-11'),
(57,2,1300,'2020-05-18'),
(58,6,1500,'2020-08-26'),
(59,3,700,'2020-05-14'),
(60,5,100,'2020-02-15'),
(61,6,1200,'2020-04-18'),
(62,6,1100,'2020-05-26'),
(63,9,2100,'2020-10-30'),
(64,11,1000,'2020-06-16'),
(65,3,100,'2020-06-09'),
(66,10,800,'2020-06-23'),
(67,9,2600,'2020-08-09'),
(68,5,3400,'2020-02-27'),
(69,1,500,'2020-06-13'),
(70,3,2300,'2020-09-23'),
(71,2,1700,'2020-04-10'),
(72,7,2800,'2020-07-08'),
(73,3,2100,'2020-04-11'),
(74,2,3200,'2020-02-25'),
(75,1,700,'2020-07-21'),
(76,10,200,'2020-07-22'),
(77,11,3400,'2020-02-05'),
(78,7,2500,'2020-06-06'),
(79,3,2300,'2020-07-09'),
(80,2,500,'2020-02-03'),
(81,4,3200,'2020-10-18'),
(82,3,100,'2020-10-23'),
(83,3,3000,'2020-05-27'),
(84,9,1400,'2020-01-16'),
(85,7,700,'2020-08-16'),
(86,11,2700,'2020-03-18'),
(87,10,1500,'2020-01-11'),
(88,2,1500,'2020-04-09'),
(89,2,1100,'2020-06-05'),
(90,8,2600,'2020-09-01'),
(91,3,2800,'2020-11-24'),
(92,7,400,'2020-04-26'),
(93,3,500,'2020-09-16'),
(94,8,2200,'2020-11-25'),
(95,8,200,'2020-10-06'),
(96,2,2700,'2020-01-28'),
(97,3,3300,'2020-08-11'),
(98,9,3100,'2020-04-24'),
(99,4,3100,'2020-01-26'),
(100,2,3300,'2020-09-17'),
(101,2,3300,'2020-11-28'),
(102,4,200,'2020-10-15'),
(103,3,2300,'2020-06-13'),
(104,4,400,'2020-08-21'),
(105,10,500,'2020-06-06'),
(106,7,400,'2020-06-16'),
(107,10,1300,'2020-05-30'),
(108,1,3500,'2020-01-28'),
(109,6,700,'2020-05-30'),
(110,4,1800,'2020-04-27'),
(111,11,700,'2020-01-24'),
(112,7,1200,'2020-05-09'),
(113,4,3500,'2020-03-14'),
(114,2,800,'2020-11-13'),
(115,9,1200,'2020-04-17'),
(116,2,100,'2020-11-24'),
(117,11,1600,'2020-03-19'),
(118,4,2300,'2020-11-23'),
(119,8,800,'2020-06-02'),
(120,7,300,'2020-09-23'),
(121,8,800,'2020-08-25'),
(122,10,3100,'2020-01-02'),
(123,10,400,'2020-05-26'),
(124,11,1500,'2020-06-30'),
(125,11,3300,'2020-04-12'),
(126,3,1700,'2020-11-19'),
(127,2,2100,'2020-03-08'),
(128,1,1900,'2020-06-14'),
(129,8,400,'2020-01-07'),
(130,6,3100,'2020-06-14'),
(131,4,2100,'2020-10-29'),
(132,10,1500,'2020-12-01'),
(133,10,1900,'2020-05-08'),
(134,1,3400,'2020-06-16'),
(135,2,1400,'2020-06-17'),
(136,3,1100,'2020-02-28'),
(137,5,2000,'2020-07-21'),
(138,10,2900,'2020-05-15'),
(139,4,3200,'2020-05-06'),
(140,5,800,'2020-06-04'),
(141,6,2500,'2020-04-18'),
(142,5,2500,'2020-11-30'),
(143,10,3100,'2020-09-06'),
(144,7,1200,'2020-01-04'),
(145,11,3400,'2020-01-15'),
(146,7,100,'2020-10-21'),
(147,2,3100,'2020-02-13'),
(148,3,2500,'2020-01-13'),
(149,7,2900,'2020-05-27'),
(150,11,3000,'2020-10-23'),
(151,10,1000,'2020-02-25'),
(152,7,900,'2020-08-09'),
(153,8,2200,'2020-01-27'),
(154,9,2400,'2020-11-20'),
(155,5,1300,'2020-05-22'),
(156,5,2200,'2020-10-13'),
(157,7,900,'2020-04-16'),
(158,4,800,'2020-06-02'),
(159,7,1200,'2020-02-06'),
(160,9,2400,'2020-06-03'),
(161,3,500,'2020-04-20'),
(162,3,3200,'2020-08-14'),
(163,1,1300,'2020-09-13'),
(164,2,2000,'2020-06-23'),
(165,2,200,'2020-07-16'),
(166,4,2100,'2020-03-27'),
(167,11,1600,'2020-05-05'),
(168,8,1100,'2020-03-24'),
(169,2,2300,'2020-03-22'),
(170,10,500,'2020-09-20'),
(171,3,300,'2020-06-06'),
(172,7,600,'2020-06-07'),
(173,6,200,'2020-03-03'),
(174,9,1800,'2020-06-04'),
(175,8,2700,'2020-02-21'),
(176,3,100,'2020-05-02'),
(177,4,400,'2020-09-22'),
(178,4,3300,'2020-11-26'),
(179,8,500,'2020-02-11'),
(180,2,600,'2020-09-04'),
(181,9,3100,'2020-07-14'),
(182,8,3000,'2020-10-12'),
(183,4,2800,'2020-02-05'),
(184,8,100,'2020-04-11'),
(185,7,200,'2020-04-27'),
(186,3,3500,'2020-09-08'),
(187,10,900,'2020-04-26'),
(188,8,1400,'2020-07-21'),
(189,5,600,'2020-06-02'),
(190,8,1800,'2020-09-14'),
(191,6,1900,'2020-11-22'),
(192,6,100,'2020-06-29'),
(193,1,3100,'2020-04-19'),
(194,4,700,'2020-06-30'),
(195,9,800,'2020-05-26'),
(196,4,2400,'2020-08-25'),
(197,7,2700,'2020-05-12'),
(198,9,1200,'2020-08-04'),
(199,8,2300,'2020-04-23'),
(200,9,2800,'2020-11-27'),
(201,1,2400,'2020-01-03'),
(202,8,400,'2020-09-15'),
(203,8,2200,'2020-04-22'),
(204,11,2000,'2020-01-12'),
(205,4,3000,'2020-01-07'),
(206,6,2100,'2020-07-03'),
(207,5,2000,'2020-11-15'),
(208,1,2800,'2020-08-11'),
(209,9,1100,'2020-02-09'),
(210,7,3100,'2020-01-16'),
(211,1,2500,'2020-06-04'),
(212,3,3100,'2020-04-13'),
(213,2,1800,'2020-02-04'),
(214,10,1800,'2020-03-31'),
(215,7,2600,'2020-03-04'),
(216,7,1700,'2020-11-18'),
(217,10,1000,'2020-07-28'),
(218,10,1800,'2020-03-20'),
(219,7,2100,'2020-10-25'),
(220,10,3100,'2020-04-18'),
(221,4,2400,'2020-02-25'),
(222,1,2300,'2020-05-27'),
(223,4,3400,'2020-01-21'),
(224,5,1900,'2020-02-07'),
(225,9,700,'2020-03-18'),
(226,7,800,'2020-09-14'),
(227,11,2600,'2020-04-27'),
(228,4,1800,'2020-08-08'),
(229,8,3000,'2020-01-10'),
(230,8,3400,'2020-03-02'),
(231,5,2400,'2020-05-03'),
(232,3,1500,'2020-04-14'),
(233,2,1600,'2020-02-11'),
(234,10,1300,'2020-09-09'),
(235,10,1800,'2020-07-28'),
(236,11,2600,'2020-04-10'),
(237,8,100,'2020-10-12'),
(238,11,900,'2020-09-29'),
(239,1,2800,'2020-05-17'),
(240,11,2100,'2020-11-27'),
(241,10,600,'2020-05-24'),
(242,5,2100,'2020-05-06'),
(243,2,2600,'2020-09-06'),
(244,8,700,'2020-08-30'),
(245,11,1700,'2020-02-14'),
(246,6,3000,'2020-01-18'),
(247,2,1000,'2020-10-04'),
(248,3,1600,'2020-09-06'),
(249,10,400,'2020-10-25'),
(250,9,3500,'2020-01-29'),
(251,5,1800,'2020-07-05'),
(252,2,2100,'2020-09-26'),
(253,11,2000,'2020-03-08'),
(254,10,400,'2020-04-11'),
(255,10,2300,'2020-01-10'),
(256,3,3300,'2020-06-01'),
(257,2,3200,'2020-03-30'),
(258,5,2600,'2020-01-18'),
(259,7,1400,'2020-02-18'),
(260,6,2700,'2020-03-13'),
(261,3,1700,'2020-08-08'),
(262,6,3400,'2020-05-25'),
(263,10,600,'2020-08-23'),
(264,2,1000,'2020-01-08'),
(265,8,1500,'2020-11-22');
